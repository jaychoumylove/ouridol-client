(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/guildComponent"],{"1d81":function(t,a,e){"use strict";var s=e("3428"),i=e.n(s);i.a},3428:function(t,a,e){},4391:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=(t._self._c,t.app.getData("userStar")),s=t.app.getData("userInfo"),i=t.app.getData("userInfo"),n=t.app.getData("userStar"),r=t.app.getData("userInfo"),p=t.app.getData("userStar"),u=t.app.getData("userCurrency"),o=t.app.getData("sysInfo"),c=t.app.getData("sysInfo").system.indexOf("iOS"),h=t.$app.getData("config"),d=t.app.getData("config"),f=t.app.getData("config");t._isMounted||(t.e0=function(a){t.tips=!1},t.e1=function(a){return t.app.goPage("/pages/user/rank/rank?starid="+t.star.id)},t.e2=function(a){return t.app.goPage("/pages/task/task")},t.e3=function(a){t.modal="invit",t.getInvitList()},t.e4=function(a){return t.app.goPage("/pages/notice/notice?id="+t.article.id)},t.e5=function(a){return a.stopPropagation(),t.app.goPage("/pages/notice/list/list")},t.e6=function(a){t.chartMsg=a.detail.value},t.e7=function(a){t.modal=""},t.e8=function(a){return t.app.goPage("/pages/recharge/recharge")},t.e9=function(a){t.sendCount=a.detail.value},t.e10=function(a){t.modal=""},t.e11=function(a){t.modal=""},t.e12=function(a){t.modal=""},t.e13=function(a){t.modal=""}),t.$mp.data=Object.assign({},{$root:{g0:e,g1:s,g2:i,g3:n,g4:r,g5:p,g6:u,g7:o,g8:c,g9:h,g10:d,g11:f}})},i=[];e.d(a,"a",function(){return s}),e.d(a,"b",function(){return i})},b7ce:function(t,a,e){"use strict";e.r(a);var s=e("4391"),i=e("da42");for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);e("1d81");var r=e("2877"),p=Object(r["a"])(i["default"],s["a"],s["b"],!1,null,"9781e1a4",null);a["default"]=p.exports},da42:function(t,a,e){"use strict";e.r(a);var s=e("f932"),i=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);a["default"]=i.a},f932:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=function(){return e.e("components/modalComponent").then(e.bind(null,"f372"))},i=function(){return e.e("components/btnComponent").then(e.bind(null,"cbb7"))},n=function(){return e.e("components/listItemComponent").then(e.bind(null,"f564"))},r=function(){return e.e("components/badgeComponent").then(e.bind(null,"8f02"))},p={components:{modalComponent:s,btnComponent:i,listItemComponent:n,badgeComponent:r},data:function(){return{app:this.$app,showLoading:!0,requestCount:7,tips:!1,userCurrency:{},star:{},userRankList:[],chartList:[],index:-1,modal:"",chartMsg:"",sendCount:0,starRankList:[],invitAward:{},invitList:[],spriteEarn:!1,rechargeList:[],danmaku:null,danmakuQueue:[],article:{},mass:{},fakeinvitList:[],fatherEarn:0}},methods:{load:function(t){this.star.id=t,this.star.id&&(this.$app.getData("userStar").id==this.star.id&&this.$app.noob&&(this.tips=!0,this.$app.noob=!1),this.getStarInfo(),this.getUserRank(),this.getChartList(),this.joinGroup(),this.getMass(),this.getInvitList(),this.getArticle(),this.checkFatherEarn(),this.initDanmaku(),this.userCurrency=this.$app.getData("userCurrency")||{coin:0,stone:0,trumpet:0})},unLoad:function(){this.leaveGroup()},goFather:function(){this.$app.getData("userStar").id?this.$app.goPage("/pages/father/father"):this.$app.toast("请先加入偶像圈")},goMass:function(){this.$app.getData("userStar").id?(this.modal="mass",this.getMass()):this.$app.toast("请先加入偶像圈")},openStealModal:function(){this.$app.getData("userStar")["id"]?(this.modal="steal",this.getStarRank()):this.$app.toast("请先加入偶像圈")},checkFatherEarn:function(){var t=this;this.$app.request(this.$app.API.USER_CHECKEARN,{},function(a){t.fatherEarn=a.data})},getMass:function(){var t=this;this.$app.request(this.$app.API.SHARE_MASS,{},function(a){if(t.mass=a.data,a.data.mass_user.length>=3&&a.data.mass_settle_time<a.data.mass_start_time&&(t.mass.isSettle=!0),a.data.lefttime){var e=parseInt(a.data.lefttime);t.mass.lefttime=t.$app.timeGethms(e).str.slice(3),clearInterval(t.$app.massTimeId),t.$app.massTimeId=setInterval(function(){t.mass.lefttime=t.$app.timeGethms(--e).str.slice(3),e<=0&&(clearInterval(t.$app.massTimeId),t.getMass())},1e3)}t.$app.closeLoading(t)})},startMass:function(){this.$app.request(this.$app.API.SHARE_STARMASS,{},function(t){})},settleMass:function(){var t=this;this.modal="",this.$app.request(this.$app.API.SHARE_SETTLEMASS,{},function(a){t.$app.toast("获得能量+"+a.data),t.getMass(),t.$app.request(t.$app.API.USER_CURRENCY,{},function(a){t.$app.setData("userCurrency",a.data),t.userCurrency=t.$app.getData("userCurrency")})})},addChartMsg:function(t){var a={uid:t.user_id,avatar:t.user&&t.user.avatarurl||this.$app.AVATAR,nickname:t.user&&t.user.nickname||this.$app.NICKNAME,content:t.content,sendtimeInt:this.$app.strToTime(t.create_time)},e=this.chartList[this.chartList.length-1]&&this.chartList[this.chartList.length-1].sendtimeInt||0;a.sendtimeInt-e>300&&(a.sendtime=t.create_time.slice(11)),this.chartList.push(a),this.$nextTick(function(){this.index=this.chartList.length-1})},startStealTimeInterval:function(t){var a=this;this.$app.timeId.push(setInterval(function(){--a.starRankList[t].steal},1e3))},initDanmaku:function(){var t=this;clearInterval(this.$app.sayworldTimeId),this.$app.sayworldTimeId=setInterval(function(){t.danmaku=t.danmakuQueue.shift()||null},1e4)},addDanmaku:function(t){this.danmakuQueue.push(t)},sayworld:function(){var t=this;this.chartMsg.trim()&&(this.chartMsg.trim().length>16?this.$app.toast("内容过长"):this.$app.request(this.$app.API.USER_SAYWORLD,{content:this.chartMsg.trim()},function(a){t.chartMsg="",t.$app.request(t.$app.API.USER_CURRENCY,{},function(a){t.$app.getData("userCurrency")["trumpet"]==a.data.trumpet?t.$app.toast("喊话失败，请稍后再试"):t.$app.toast("喊话成功","success"),t.$app.setData("userCurrency",a.data),t.userCurrency=t.$app.getData("userCurrency")})}))},getUserInfo:function(t){var a=this,e=t.detail.userInfo;e&&this.$app.request(this.$app.API.USER_SAVEINFO,e,function(t){a.$app.request(a.$app.API.USER_INFO,{},function(t){a.$app.setData("userInfo",t.data),a.sendOrFollow()})},"POST",!0)},steal:function(t,a,e){var s=this;e>0||this.$app.request(this.$app.API.STAR_STEAL,{starid:t,index:a},function(t){s.$app.toast("偷到了".concat(t.data.count,"能量")),s.getStarRank(),s.$app.request(s.$app.API.USER_CURRENCY,{},function(t){s.$app.setData("userCurrency",t.data)})},"POST",!0)},getInvitAward:function(t,a){var e=this;1==a&&this.$app.request(this.$app.API.USER_INVITAWARD,{ral_user_id:t},function(t){e.$app.toast("领取成功"),e.getFakeInviteList(),e.$app.request(e.$app.API.USER_CURRENCY,{},function(t){e.$app.setData("userCurrency",t.data)})},"POST",!0)},goOther:function(t){this.modal="",this.$app.goPage("/pages/pet/other/other?user_id="+t)},getFakeInviteList:function(){var t=this;this.modal="invit_desert",this.$app.request(this.$app.API.USER_INVITLIST,{},function(a){t.invitAward=a.data.award;var e=[];a.data.list.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,status:a.status,uid:a.ral_user_id})}),t.fakeinvitList=e,t.$app.closeLoading(t)})},getInvitList:function(){var t=this;this.$app.request(this.$app.API.USER_INVITLIST,{type:1},function(a){t.invitAward=a.data.award;var e=[];t.spriteEarn=!1,a.data.list.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,status:a.status,uid:a.user&&a.user.id,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,earn:a.sprite.earn}),a.sprite.earn>=100&&(t.spriteEarn=!0)}),t.invitList=e,t.$app.closeLoading(t)})},sendHot:function(t){var a=this;t&&(this.sendCount=t),parseInt(this.sendCount)?this.$app.request(this.$app.API.STAR_SENDHOT,{starid:this.star.id,hot:parseInt(this.sendCount)},function(t){a.modal="",a.getStarInfo(),a.$app.request(a.$app.API.USER_CURRENCY,{},function(t){a.$app.setData("userCurrency",t.data)}),a.$app.toast("打榜成功")},"POST",!0):this.$app.toast("数额不正确")},sendMsg:function(){var t=this;this.chartMsg.trim()&&(this.$app.socketTask&&2!=this.$app.socketTask.readyState&&3!=this.$app.socketTask.readyState||this.$app.initSocket(),this.$app.request(this.$app.API.STAR_SENDMSG,{starid:this.star.id,content:this.chartMsg.trim()},function(a){t.chartMsg=""}))},sendOrFollow:function(t){var a=this;if(this.$app.getData("userStar")["id"])if(this.$app.getData("userStar")["id"]==this.star.id){this.modal="send";var e=t&&t.detail&&t.detail.formId||null;e&&this.$app.request(this.$app.API.EXT_SAVEFORMID,{formId:e})}else this.$app.toast("不能为其他爱豆打榜哦~");else this.$app.modal("每个人只能加入一个偶像圈\n是否加入".concat(this.star.name,"的偶像圈？"),function(){a.$app.request(a.$app.API.STAR_FOLLOW,{starid:a.star.id,rer_user_id:a.$app.getData("referrer")},function(t){a.$app.request(a.$app.API.USER_STAR,{},function(t){a.$app.setData("userStar",t.data),a.$app.goPage("/pages/group/group")})},"POST",!0)})},getStarInfo:function(){var t=this;this.$app.request(this.$app.API.STAR_INFO,{starid:this.star.id},function(a){var e=a.data;t.star={id:e.id,avatar:e.head_img_s?e.head_img_s:e.head_img_l,name:e.name,weekHot:t.$app.formatNumberRgx(e.star_rank.week_hot),monthHot:t.$app.formatNumberRgx(e.star_rank.month_hot),weekRank:e.star_rank.week_hot_rank,monthRank:e.star_rank.month_hot_rank},t.$app.closeLoading(t)})},getArticle:function(){var t=this;this.$app.request(this.$app.API.ARTICLE,{},function(a){t.article.name=a.data.name,t.article.id=a.data.id,t.$app.closeLoading(t)})},getStarRank:function(){var t=this;this.$app.request(this.$app.API.STAR_RANK,{type:1},function(a){console.log("steal",t.$app.timeId),t.$app.timeId||(t.$app.timeId=[]);var e=!0,s=!1,i=void 0;try{for(var n,r=t.$app.timeId[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var p=n.value;clearInterval(p)}}catch(c){s=!0,i=c}finally{try{e||null==r.return||r.return()}finally{if(s)throw i}}t.$app.timeId=[];var u=[],o=0;a.data.list.forEach(function(e,s){s<6&&e.star.id!=t.$app.getData("userStar")["id"]&&(u.push({starid:e.star.id,name:e.star.name,steal_count:a.data.steal_count,avatar:e.star.head_img_s?e.star.head_img_s:e.star.head_img_l,hot:t.$app.formatNumberRgx(e["week_hot"]),steal:a.data.steal[o]}),a.data.steal[o]>0&&t.startStealTimeInterval(o),o++)}),t.starRankList=u})},getUserRank:function(){var t=this;this.$app.request(this.$app.API.USER_RANK,{starid:this.star.id},function(a){var e=[];a.data.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,hot:a.thisweek_count})}),t.userRankList=e,t.$app.closeLoading(t)})},getChartList:function(){var t=this;this.$app.request(this.$app.API.STAR_CHART,{starid:this.star.id},function(a){var e=[];a.data.forEach(function(a,s){var i={uid:a.user&&a.user.id,avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,content:a.content,sendtimeInt:t.$app.strToTime(a.create_time)},n=e[s-1]&&e[s-1].sendtimeInt||0;i.sendtimeInt-n>300&&(i.sendtime=a.create_time.slice(11)),e.push(i)}),t.chartList=e,t.$nextTick(function(){this.index=this.chartList.length-1}),t.$app.closeLoading(t)})},joinGroup:function(){var t=this;this.$app.request(this.$app.API.STAR_JOINCHART,{star_id:this.star.id,client_id:this.$app.getData("clientId")},function(a){t.$app.closeLoading(t)})},leaveGroup:function(){this.$app.request(this.$app.API.STAR_LEAVECHART,{star_id:this.star.id,client_id:this.$app.getData("clientId")},function(t){})}}};a.default=p}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/guildComponent-create-component',
    {
        'components/guildComponent-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("b7ce"))
        })
    },
    [['components/guildComponent-create-component']]
]);                
