(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pet/pet"],{"10f3":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){return n.e("components/modalComponent").then(n.bind(null,"f372"))},a=function(){return n.e("components/btnComponent").then(n.bind(null,"cbb7"))},r=function(){return n.e("components/listItemComponent").then(n.bind(null,"f564"))},s={components:{modalComponent:i,btnComponent:a,listItemComponent:r},data:function(){return{requestCount:1,invitListPage:1,userCurrency:this.$app.getData("userCurrency")||{coin:0,stone:0,trumpet:0},spriteInfo:this.$app.getData("pet_spriteInfo")||{sprite_level:0,earnPer:0},invitList:[],invitAward:"",modal:"",modalTitle:"",earnCuttime:1,skillShow:!1,skillList:[],currentSkillType:1}},onShareAppMessage:function(t){var e=t.target&&t.target.dataset.share;return this.$app.commonShareAppMessage(e)},onLoad:function(){t.hideTabBarRedDot({index:1})},onShow:function(){this.getSpriteInfo(),this.initInterval(),this.getInvitList(),this.userCurrency=this.$app.getData("userCurrency")||{coin:0,stone:0,trumpet:0}},methods:{initInterval:function(){var t=this;clearInterval(this.$app.petTimeId),this.$app.petTimeId=setInterval(function(){t.earnCuttime++,t.earnCuttime>100&&(t.earnCuttime=1,t.getSpriteInfo())},1e3)},tapSprite:function(){var t=this;this.spriteInfo.need_stone&&this.userCurrency.stone>=this.spriteInfo.need_stone&&this.$app.request(this.$app.API.SPRITE_UPGRAGE,{},function(e){t.$app.request(t.$app.API.USER_CURRENCY,{},function(e){t.$app.setData("userCurrency",e.data),t.userCurrency=t.$app.getData("userCurrency")}),t.getSpriteInfo(),t.$app.toast("升级成功","success")},"POST",!0)},openSkillModal:function(t){this.modal="skill",this.currentSkillType=t,this.getSkill()},openInvitModal:function(){this.modal="invit",this.invitListPage=1,this.getInvitList()},skillUpgrade:function(){var t=this;this.modal="",this.$app.request(this.$app.API.SPRITE_UPGRAGE,{type:this.currentSkillType},function(e){t.$app.request(t.$app.API.USER_CURRENCY,{},function(e){t.$app.setData("userCurrency",e.data),t.userCurrency=t.$app.getData("userCurrency")}),t.getSpriteInfo(),t.$app.toast("升级成功","success")})},getSkill:function(){var t=this;this.$app.request(this.$app.API.SPRITE_SKILL,{type:this.currentSkillType},function(e){var n=[];if(1==t.currentSkillType){t.modalTitle="助人为乐";var i=!0,a=!1,r=void 0;try{for(var s,p=e.data[Symbol.iterator]();!(i=(s=p.next()).done);i=!0){var o=s.value,u={level:o.level,desc:"对方"+o.percent+"%能量的奖励",need_stone:"升级需要消耗"+o.need_stone+"灵丹",avatar:"/static/image/pet/skillone-n.png"};o.level<=t.spriteInfo.skillone_level&&(u.status=1),n.push(u)}}catch(c){a=!0,r=c}finally{try{i||null==p.return||p.return()}finally{if(a)throw r}}}t.skillList=n})},settleSprite:function(t,e){var n=this;e.earn<2?this.$app.toast("TA的能量太少了，稍后再来吧"):this.$app.request(this.$app.API.SPRITE_SETTLE,{user_id:e.uid},function(e){n.invitList[t].earn=0,n.$app.toast("为TA收集能量，你获得:"+e.data+"能量"),n.$app.request(n.$app.API.USER_CURRENCY,{},function(t){n.$app.setData("userCurrency",t.data)})},"POST",!0)},getInvitList:function(){var t=this;this.$app.request(this.$app.API.USER_INVITLIST,{type:1,page:this.invitListPage||1},function(e){t.invitAward=e.data.award;var n=[];t.spriteEarn=!1,e.data.list.forEach(function(e,i){n.push({avatar:e.user&&e.user.avatarurl||t.$app.AVATAR,status:e.status,uid:e.user&&e.user.id||0,nickname:e.user&&e.user.nickname||t.$app.NICKNAME,earn:e.sprite.earn}),e.sprite.earn>=100&&(t.spriteEarn=!0)}),1==t.invitListPage?t.invitList=n:t.invitList=t.invitList.concat(n),t.$app.closeLoading(t)})},goOther:function(t){this.modal="",this.$app.goPage("/pages/pet/other/other?user_id="+t)},settle:function(){var t=this;0==this.spriteInfo.earn?this.$app.toast("能量太少了，稍后再来吧"):this.$app.request(this.$app.API.SPRITE_SETTLE,{user_id:this.$app.getData("userInfo").id,settle:this.spriteInfo.earn},function(e){t.getSpriteInfo(),t.$app.toast("收集成功,能量+"+e.data),t.$app.request(t.$app.API.USER_CURRENCY,{},function(e){t.$app.setData("userCurrency",e.data),t.userCurrency=t.$app.getData("userCurrency")}),t.earnCuttime=0,t.initInterval()},"POST",!0)},getSpriteInfo:function(){var t=this;this.$app.request(this.$app.API.SPRITE_INFO,{user_id:this.$app.getData("userInfo").id},function(e){t.spriteInfo=e.data,e.data.isFull?(t.$app.toast("能量已满了，快点收能量吧"),clearInterval(t.$app.petTimeId),t.earnCuttime=100):t.initInterval(),t.$app.setData("pet_spriteInfo",t.spriteInfo),t.$app.closeLoading(t)})}}};e.default=s}).call(this,n("543d")["default"])},"5d5f":function(t,e,n){"use strict";n.r(e);var i=n("67f3"),a=n("8e66");for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);n("7e6f");var s=n("2877"),p=Object(s["a"])(a["default"],i["a"],i["b"],!1,null,"50e87778",null);e["default"]=p.exports},"67f3":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.$app.getData("config"));t._isMounted||(t.e0=function(e){return t.$app.goPage("/pages/notice/notice?id=2")},t.e1=function(e){t.modal="tips"},t.e2=function(e){t.modal=""},t.e3=function(e){t.invitListPage++,t.getInvitList()},t.e4=function(e){t.modal=""},t.e5=function(e){t.modal=""},t.e6=function(e){return t.$app.goPage("/pages/task/task")}),t.$mp.data=Object.assign({},{$root:{g0:n}})},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})},"7e6f":function(t,e,n){"use strict";var i=n("ef92"),a=n.n(i);a.a},"8e66":function(t,e,n){"use strict";n.r(e);var i=n("10f3"),a=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);e["default"]=a.a},ef92:function(t,e,n){}},[["0339","common/runtime","common/vendor"]]]);