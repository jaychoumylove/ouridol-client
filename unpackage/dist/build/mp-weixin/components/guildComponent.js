(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/guildComponent"],{"205a":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=function(){return e.e("components/modalComponent").then(e.bind(null,"829d"))},i=function(){return e.e("components/btnComponent").then(e.bind(null,"57b2"))},n=function(){return e.e("components/listItemComponent").then(e.bind(null,"a2a3"))},r=function(){return e.e("components/badgeComponent").then(e.bind(null,"37cd"))},p=function(){return e.e("components/countToComponent").then(e.bind(null,"1918"))},u={components:{modalComponent:s,btnComponent:i,listItemComponent:n,badgeComponent:r,countToComponent:p},data:function(){return{app:this.$app,showLoading:!0,requestCount:7,tips:!1,userCurrency:{},star:{weekRank:0},userRankList:[],chartList:[],index:-1,modal:"",chartMsg:"",sendCount:0,starRankList:[],invitAward:{},invitList:[],invitNum:10,invitListPage:1,hasInvitcount:0,spriteEarn:!1,rechargeList:[],danmaku:null,danmakuQueue:[],article:{},mass:{},fakeinvitList:[],invitFakePage:1,fatherEarn:0,activeInfo:{active_info:{target_people:2e3},can_card:!0,complete_people:0,join_people:0}}},created:function(){},methods:{load:function(t){this.star.id=t,this.star.id&&(this.$app.getData("userStar").id==this.star.id&&this.$app.noob&&(this.tips=!0,this.$app.noob=!1),this.loadData(),this.initDanmaku(),this.userCurrency=this.$app.getData("userCurrency")||{coin:0,stone:0,trumpet:0})},unLoad:function(){this.leaveGroup()},loadData:function(){var t=this,a=this.$app.getData("clientId");a?this.$app.request("page/group",{starid:this.star.id,client_id:a},function(a){var e=a.data.starInfo;t.star={id:e.id,avatar:e.head_img_s?e.head_img_s:e.head_img_l,name:e.name,weekHot:t.$app.formatNumberRgx(e.star_rank.week_hot),weekRank:e.star_rank.week_hot_rank};var s=[];a.data.userRank.forEach(function(a,e){s.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,hot:a.thisweek_count})}),t.userRankList=s;var i=[];if(a.data.chartList.forEach(function(a,e){var s={uid:a.user&&a.user.id,avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,content:a.content,captain:a.user&&a.user.user_star&&a.user.user_star.captain||0,sendtimeInt:t.$app.strToTime(a.create_time)},n=i[e-1]&&i[e-1].sendtimeInt||0;s.sendtimeInt-n>300&&(s.sendtime=a.create_time.slice(11)),i.push(s)}),t.chartList=i,t.$nextTick(function(){this.index=this.chartList.length-1}),t.mass=a.data.mass,a.data.mass.mass_user.length>=3&&a.data.mass.mass_settle_time<a.data.mass.mass_start_time&&(t.mass.isSettle=!0),a.data.mass.lefttime){var n=parseInt(a.data.mass.lefttime);t.mass.lefttime=t.$app.timeGethms(n).str.slice(3),clearInterval(t.$app.massTimeId),t.$app.massTimeId=setInterval(function(){t.mass.lefttime=t.$app.timeGethms(--n).str.slice(3),n<=0&&(clearInterval(t.$app.massTimeId),t.getMass())},1e3)}t.invitAward=a.data.invitList.award;var r=[];t.spriteEarn=!1,a.data.invitList.list.forEach(function(a,e){r.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,status:a.status,uid:a.user&&a.user.id||0,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,earn:a.sprite.earn}),a.sprite.earn>=100&&(t.spriteEarn=!0)}),1==t.invitListPage?t.invitList=r:t.invitList=t.invitList.concat(r),t.article.name=a.data.article.name,t.article.id=a.data.article.id,t.fatherEarn=a.data.fatherEarn,t.activeInfo=a.data.activeInfo}):(this.$app.invokeSocket(),setTimeout(function(){t.loadData()},1500))},goActive:function(){this.$app.getData("userStar").id?this.$app.getData("userStar").id==this.star.id?this.$app.goPage("/pages/active_one/active_one?starid="+this.star.id):this.$app.toast("请进入自己的偶像圈打卡"):this.$app.toast("请先加入偶像圈")},goFather:function(){this.$app.getData("userStar").id?this.$app.goPage("/pages/father/father"):this.$app.toast("请先加入偶像圈")},goMass:function(){this.$app.getData("userStar").id?(this.modal="mass",this.getMass()):this.$app.toast("请先加入偶像圈")},openStealModal:function(){this.$app.getData("userStar")["id"]?(this.modal="steal",this.getStarRank()):this.$app.toast("请先加入偶像圈")},getActiveInfo:function(){var t=this;this.$app.request(this.$app.API.EXT_ACTIVEINFO,{starid:this.star.id},function(a){t.activeInfo=a.data})},checkFatherEarn:function(){var t=this;this.$app.request(this.$app.API.USER_CHECKEARN,{},function(a){t.fatherEarn=a.data})},settleSprite:function(t,a){var e=this;a.earn<2?this.$app.toast("TA的能量太少了，稍后再来吧"):this.$app.request(this.$app.API.SPRITE_SETTLE,{user_id:a.uid},function(a){e.invitList[t].earn=0,e.$app.toast("为TA收集能量，你获得:"+a.data+"能量"),e.$app.request(e.$app.API.USER_CURRENCY,{},function(t){e.$app.setData("userCurrency",t.data)})},"POST",!0)},getMass:function(){var t=this;this.$app.request(this.$app.API.SHARE_MASS,{},function(a){if(t.mass=a.data,a.data.mass_user.length>=3&&a.data.mass_settle_time<a.data.mass_start_time&&(t.mass.isSettle=!0),a.data.lefttime){var e=parseInt(a.data.lefttime);t.mass.lefttime=t.$app.timeGethms(e).str.slice(3),clearInterval(t.$app.massTimeId),t.$app.massTimeId=setInterval(function(){t.mass.lefttime=t.$app.timeGethms(--e).str.slice(3),e<=0&&(clearInterval(t.$app.massTimeId),t.getMass())},1e3)}t.$app.closeLoading(t)})},startMass:function(){this.$app.request(this.$app.API.SHARE_STARMASS,{},function(t){})},settleMass:function(){var t=this;this.modal="",this.$app.request(this.$app.API.SHARE_SETTLEMASS,{},function(a){t.$app.toast("获得能量+"+a.data),t.getMass(),t.$app.request(t.$app.API.USER_CURRENCY,{},function(a){t.$app.setData("userCurrency",a.data),t.userCurrency=t.$app.getData("userCurrency")})})},addChartMsg:function(t){var a={uid:t.user_id,avatar:t.user&&t.user.avatarurl||this.$app.AVATAR,nickname:t.user&&t.user.nickname||this.$app.NICKNAME,content:t.content,captain:t.user&&t.user.user_star&&t.user.user_star.captain||0,sendtimeInt:this.$app.strToTime(t.create_time)},e=this.chartList[this.chartList.length-1]&&this.chartList[this.chartList.length-1].sendtimeInt||0;a.sendtimeInt-e>300&&(a.sendtime=t.create_time.slice(11)),this.chartList.push(a),this.$nextTick(function(){this.index=this.chartList.length-1})},startStealTimeInterval:function(t){var a=this;this.$app.timeId.push(setInterval(function(){--a.starRankList[t].steal},1e3))},initDanmaku:function(){var t=this;clearInterval(this.$app.sayworldTimeId),this.danmaku=null,this.$app.sayworldTimeId=setInterval(function(){t.danmaku=t.danmakuQueue.shift()||null},1e4)},addDanmaku:function(t){this.danmakuQueue.push(t)},sayworld:function(){var t=this;this.chartMsg.trim()&&(this.chartMsg.trim().length>16?this.$app.toast("内容过长"):this.$app.request(this.$app.API.USER_SAYWORLD,{content:this.chartMsg.trim()},function(a){t.chartMsg="",t.$app.request(t.$app.API.USER_CURRENCY,{},function(a){t.$app.getData("userCurrency")["trumpet"]==a.data.trumpet?t.$app.toast("喊话失败，请稍后再试"):t.$app.toast("喊话成功","success"),t.$app.setData("userCurrency",a.data),t.userCurrency=t.$app.getData("userCurrency")})}))},getUserInfo:function(t){var a=this,e=t.detail.userInfo;e&&this.$app.request(this.$app.API.USER_SAVEINFO,{iv:t.detail.iv,encryptedData:t.detail.encryptedData},function(t){a.$app.request(a.$app.API.USER_INFO,{},function(t){a.$app.setData("userInfo",t.data,!0),a.sendOrFollow()})},"POST",!0)},steal:function(t,a,e){var s=this;e>0||this.$app.request(this.$app.API.STAR_STEAL,{starid:t,index:a},function(t){s.$app.toast("偷到了".concat(t.data.count,"能量")),s.getStarRank(),s.$app.request(s.$app.API.USER_CURRENCY,{},function(t){s.$app.setData("userCurrency",t.data)})},"POST",!0)},getInvitAward:function(t,a,e){var s=this;1==a&&this.$app.request(this.$app.API.USER_INVITAWARD,{ral_user_id:t},function(t){s.fakeinvitList[e].status=2,s.$app.toast("领取成功"),s.$app.request(s.$app.API.USER_CURRENCY,{},function(t){s.$app.setData("userCurrency",t.data)})},"POST",!0)},goOther:function(t){this.modal="",this.$app.goPage("/pages/pet/other/other?user_id="+t)},getFakeInviteList:function(){var t=this;this.$app.request(this.$app.API.USER_INVITLIST,{page:this.invitFakePage},function(a){t.invitAward=a.data.award,t.hasInvitcount=a.data.hasInvitcount;var e=[];a.data.list.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,status:a.status,uid:a.ral_user_id})}),1==t.invitFakePage?t.fakeinvitList=e:t.fakeinvitList=t.fakeinvitList.concat(e),t.$app.closeLoading(t)})},getInvitList:function(){var t=this;this.$app.request(this.$app.API.USER_INVITLIST,{type:1,page:this.invitListPage||1},function(a){t.invitAward=a.data.award;var e=[];t.spriteEarn=!1,a.data.list.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,status:a.status,uid:a.user&&a.user.id||0,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,earn:a.sprite.earn}),a.sprite.earn>=100&&(t.spriteEarn=!0)}),1==t.invitListPage?t.invitList=e:t.invitList=t.invitList.concat(e),t.$app.closeLoading(t)})},sendHot:function(t){var a=this;t&&(this.sendCount=t),parseInt(this.sendCount)?this.$app.request(this.$app.API.STAR_SENDHOT,{starid:this.star.id,hot:parseInt(this.sendCount)},function(t){a.modal="",a.getStarInfo(),a.$app.request(a.$app.API.USER_CURRENCY,{},function(t){a.$app.setData("userCurrency",t.data)}),a.$app.toast("打榜成功","success")},"POST",!0):this.$app.toast("数额不正确")},sendMsg:function(){var t=this;this.chartMsg.trim()&&(this.$app.invokeSocket(),this.$app.request(this.$app.API.STAR_SENDMSG,{starid:this.star.id,content:this.chartMsg.trim()},function(a){t.chartMsg=""}))},sendOrFollow:function(t){var a=this;if(this.$app.getData("userInfo").nickname){if(this.$app.getData("userStar")["id"]){if(this.$app.getData("userStar")["id"]==this.star.id){this.modal="send";var e=t&&t.detail&&t.detail.formId||null;return void(e&&"the formId is a mock one"!=e&&this.$app.request(this.$app.API.EXT_SAVEFORMID,{formId:e}))}if(0==this.$app.getData("userInfo").type)return void this.$app.toast("不能为其他爱豆打榜")}this.$app.modal("每个人只能加入一个偶像圈\n是否加入".concat(this.star.name,"的偶像圈？"),function(){a.$app.request(a.$app.API.STAR_FOLLOW,{starid:a.star.id,rer_user_id:a.$app.getData("referrer")},function(t){1==a.$app.getData("userInfo").type?(a.$app.setData("token","",!0),a.$app.request(a.$app.API.USER_INFO,{},function(t){a.$app.setData("userInfo",t.data,!0),a.$app.request(a.$app.API.USER_CURRENCY,{},function(t){a.$app.setData("userCurrency",t.data)}),a.$app.request(a.$app.API.USER_STAR,{},function(t){a.$app.setData("userStar",t.data,!0),a.$app.goPage("/pages/group/group")})})):a.$app.request(a.$app.API.USER_STAR,{},function(t){a.$app.setData("userStar",t.data,!0),a.chartMsg="大家好，我是".concat(a.$app.getData("userInfo").nickname,"，初来乍到，请多关照~"),a.sendMsg(),a.$app.goPage("/pages/group/group")})},"POST",!0)})}else this.$app.toast("请先去个人中心点击头像进行授权")},getStarInfo:function(){var t=this;this.$app.request(this.$app.API.STAR_INFO,{starid:this.star.id},function(a){var e=a.data;t.star={id:e.id,avatar:e.head_img_s?e.head_img_s:e.head_img_l,name:e.name,weekHot:t.$app.formatNumberRgx(e.star_rank.week_hot),weekRank:e.star_rank.week_hot_rank},t.$app.closeLoading(t)})},getArticle:function(){var t=this;this.$app.request(this.$app.API.ARTICLE,{},function(a){t.article.name=a.data.name,t.article.id=a.data.id,t.$app.closeLoading(t)})},getStarRank:function(){var t=this;this.$app.request(this.$app.API.STAR_RANK,{type:1},function(a){console.log("steal",t.$app.timeId),t.$app.timeId||(t.$app.timeId=[]);var e=!0,s=!1,i=void 0;try{for(var n,r=t.$app.timeId[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var p=n.value;clearInterval(p)}}catch(c){s=!0,i=c}finally{try{e||null==r.return||r.return()}finally{if(s)throw i}}t.$app.timeId=[];var u=[],o=0;a.data.list.forEach(function(e,s){s<6&&e.star.id!=t.$app.getData("userStar")["id"]&&(u.push({starid:e.star.id,name:e.star.name,steal_count:a.data.steal_count,avatar:e.star.head_img_s?e.star.head_img_s:e.star.head_img_l,hot:t.$app.formatNumberRgx(e["week_hot"]),steal:a.data.steal[o]}),a.data.steal[o]>0&&t.startStealTimeInterval(o),o++)}),t.starRankList=u})},getUserRank:function(){var t=this;this.$app.request(this.$app.API.USER_RANK,{starid:this.star.id},function(a){var e=[];a.data.forEach(function(a,s){e.push({avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,hot:a.thisweek_count})}),t.userRankList=e,t.$app.closeLoading(t)})},getChartList:function(){var t=this;this.$app.request(this.$app.API.STAR_CHART,{starid:this.star.id},function(a){var e=[];a.data.forEach(function(a,s){var i={uid:a.user&&a.user.id,avatar:a.user&&a.user.avatarurl||t.$app.AVATAR,nickname:a.user&&a.user.nickname||t.$app.NICKNAME,content:a.content,captain:a.user&&a.user.user_star&&a.user.user_star.captain||0,sendtimeInt:t.$app.strToTime(a.create_time)},n=e[s-1]&&e[s-1].sendtimeInt||0;i.sendtimeInt-n>300&&(i.sendtime=a.create_time.slice(11)),e.push(i)}),t.chartList=e,t.$nextTick(function(){this.index=this.chartList.length-1}),t.$app.closeLoading(t)})},joinGroup:function(){var t=this,a=this.$app.getData("clientId");a?this.$app.request(this.$app.API.STAR_JOINCHART,{star_id:this.star.id,client_id:a},function(a){t.$app.closeLoading(t)}):(this.$app.invokeSocket(),setTimeout(function(){t.joinGroup()},1500))},leaveGroup:function(){var t=this.$app.getData("clientId");t&&this.$app.request(this.$app.API.STAR_LEAVECHART,{star_id:this.star.id,client_id:t},function(t){})}}};a.default=u},5696:function(t,a,e){"use strict";var s=e("d645"),i=e.n(s);i.a},7199:function(t,a,e){"use strict";e.r(a);var s=e("205a"),i=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(a,t,function(){return s[t]})}(n);a["default"]=i.a},bbc7:function(t,a,e){"use strict";e.r(a);var s=e("be1a"),i=e("7199");for(var n in i)"default"!==n&&function(t){e.d(a,t,function(){return i[t]})}(n);e("5696");var r=e("2877"),p=Object(r["a"])(i["default"],s["a"],s["b"],!1,null,"0b38b5aa",null);a["default"]=p.exports},be1a:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=(t._self._c,t.app.getData("userStar")),s=t.app.getData("userInfo"),i=t.app.getData("userStar"),n=t.app.getData("userInfo"),r=t.app.getData("userInfo"),p=t.app.getData("userInfo"),u=t.app.getData("userInfo"),o=t.app.getData("userStar"),c=t.app.getData("userInfo"),d=t.app.getData("userInfo"),h=t.app.getData("userStar"),f=t.app.getData("userCurrency"),l=t.app.getData("sysInfo").system.indexOf("iOS"),g=t.app.getData("sysInfo").system.indexOf("iOS"),m=t.$app.getData("config"),$=t.$app.getData("userInfo"),v=t.$app.getData("config"),I=t.app.getData("config"),_=t.app.getData("config"),A=t.app.getData("config");t._isMounted||(t.e0=function(a){t.tips=!1},t.e1=function(a){return t.app.goPage("/pages/user/rank/rank?starid="+t.star.id)},t.e2=function(a){return t.app.goPage("/pages/task/task")},t.e3=function(a){t.getStarRank(),t.modal="steal"},t.e4=function(a){t.invitFakePage=1,t.modal="invit_desert",t.getFakeInviteList()},t.e5=function(a){return t.app.goPage("/pages/notice/notice?id="+t.article.id)},t.e6=function(a){return a.stopPropagation(),t.app.goPage("/pages/notice/list/list")},t.e7=function(a){t.chartMsg=a.detail.value},t.e8=function(a){t.modal=""},t.e9=function(a){return t.app.goPage("/pages/recharge/recharge")},t.e10=function(a){t.sendCount=a.detail.value},t.e11=function(a){t.modal=""},t.e12=function(a){t.modal=""},t.e13=function(a){t.invitFakePage++,t.getFakeInviteList()},t.e14=function(a){t.modal=""},t.e15=function(a){t.modal=""},t.e16=function(a){t.invitListPage++,t.getInvitList()},t.e17=function(a){t.modal=""},t.e18=function(a){return t.$app.goPage("/pages/task/task")}),t.$mp.data=Object.assign({},{$root:{g0:e,g1:s,g2:i,g3:n,g4:r,g5:p,g6:u,g7:o,g8:c,g9:d,g10:h,g11:f,g12:l,g13:g,g14:m,g15:$,g16:v,g17:I,g18:_,g19:A}})},i=[];e.d(a,"a",function(){return s}),e.d(a,"b",function(){return i})},d645:function(t,a,e){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/guildComponent-create-component',
    {
        'components/guildComponent-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("bbc7"))
        })
    },
    [['components/guildComponent-create-component']]
]);                
